2025-08-08 09:43:57,400 - INFO - ğŸš€ Initializing PAGE-WISE XGBoost Trainer with Undersampling
2025-08-08 09:43:57,400 - INFO - ğŸ“‚ Embeddings directory: readability_training_pagewise/embeddings
2025-08-08 09:43:57,400 - INFO - ğŸ“‚ Experiment directory: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357
2025-08-08 09:43:57,400 - INFO - ğŸ§  Backbone model: efficientnet
2025-08-08 09:43:57,400 - INFO - âš–ï¸ Sampling strategy: random
2025-08-08 09:43:57,400 - INFO - ğŸ“š Loading page-wise features and labels...
2025-08-08 09:43:57,401 - INFO - ğŸ“‚ Using embeddings from: readability_training_pagewise/embeddings/efficientnet_pagewise_embeddings_20250806_181332
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Train features: (476, 1280)
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Train labels: (476,)
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Test features: (122, 1280)
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Test labels: (122,)
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Feature dimension: 1280
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Classification type: page_wise
2025-08-08 09:43:57,405 - INFO - âœ… Feature-to-image mapping verified
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Original train class distribution: {np.float32(0.0): np.int64(152), np.float32(1.0): np.int64(324)}
2025-08-08 09:43:57,405 - INFO - ğŸ“Š Test class distribution: {np.float32(0.0): np.int64(41), np.float32(1.0): np.int64(81)}
2025-08-08 09:43:57,406 - INFO - ğŸš€ Starting XGBoost training for PAGE-WISE readability classification...
2025-08-08 09:43:57,406 - INFO - âš–ï¸ Applying undersampling technique: random
2025-08-08 09:43:57,408 - INFO - ğŸ“Š Resampled train class distribution: {np.float32(0.0): np.int64(152), np.float32(1.0): np.int64(152)}
2025-08-08 09:43:57,409 - INFO - ğŸ“Š Original samples: 476 â†’ Resampled samples: 304
2025-08-08 09:43:57,409 - INFO - ğŸ”§ MEDIUM hyperparameter tuning for PAGE-WISE classification...
2025-08-08 09:43:57,409 - INFO - ğŸ“Š Total parameter combinations: 16
2025-08-08 09:43:57,409 - INFO - ğŸ”„ Cross-validation folds: 3
2025-08-08 09:43:57,409 - INFO - â±ï¸  Estimated time: 0.4 - 1.2 minutes
2025-08-08 09:43:57,409 - INFO - ğŸš€ Starting hyperparameter search...
2025-08-08 09:44:56,315 - INFO - âœ… Hyperparameter search completed!
2025-08-08 09:44:56,316 - INFO - â±ï¸  Total training time: 0:00:58.905847
2025-08-08 09:44:56,316 - INFO - ğŸ† Best parameters found:
2025-08-08 09:44:56,316 - INFO -    colsample_bytree: 0.8
2025-08-08 09:44:56,316 - INFO -    learning_rate: 0.1
2025-08-08 09:44:56,316 - INFO -    max_depth: 3
2025-08-08 09:44:56,316 - INFO -    n_estimators: 200
2025-08-08 09:44:56,316 - INFO -    reg_alpha: 0
2025-08-08 09:44:56,316 - INFO -    reg_lambda: 1
2025-08-08 09:44:56,316 - INFO -    subsample: 0.8
2025-08-08 09:44:56,316 - INFO - ğŸ† Best CV F1 score: 0.2600
2025-08-08 09:44:56,326 - INFO - ğŸ” Top parameter combinations:
2025-08-08 09:44:56,327 - INFO -    1. F1: 0.2600 (Â±0.1108) - {'colsample_bytree': 0.8, 'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 200, 'reg_alpha': 0, 'reg_lambda': 1, 'subsample': 0.8}
2025-08-08 09:44:56,328 - INFO -    2. F1: 0.2593 (Â±0.1039) - {'colsample_bytree': 0.8, 'learning_rate': 0.2, 'max_depth': 3, 'n_estimators': 200, 'reg_alpha': 0, 'reg_lambda': 1, 'subsample': 0.8}
2025-08-08 09:44:56,328 - INFO -    3. F1: 0.2566 (Â±0.1057) - {'colsample_bytree': 0.8, 'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 100, 'reg_alpha': 0, 'reg_lambda': 1, 'subsample': 0.8}
2025-08-08 09:44:56,328 - INFO -    4. F1: 0.2522 (Â±0.0909) - {'colsample_bytree': 0.8, 'learning_rate': 0.2, 'max_depth': 3, 'n_estimators': 100, 'reg_alpha': 0, 'reg_lambda': 1, 'subsample': 0.8}
2025-08-08 09:44:56,328 - INFO -    5. F1: 0.2428 (Â±0.0981) - {'colsample_bytree': 0.8, 'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 100, 'reg_alpha': 0, 'reg_lambda': 1, 'subsample': 1.0}
2025-08-08 09:44:56,329 - INFO - ğŸ“Š Evaluating best model on training and test sets...
2025-08-08 09:44:56,329 - INFO - ğŸ” Evaluating on original train set (476 samples)...
2025-08-08 09:44:56,347 - INFO - ğŸ“Š TRAIN RESULTS (Non-readable as positive):
2025-08-08 09:44:56,348 - INFO -    ğŸ“ˆ Accuracy:  0.8845
2025-08-08 09:44:56,348 - INFO -    ğŸ“ˆ Precision: 0.7343
2025-08-08 09:44:56,348 - INFO -    ğŸ“ˆ Recall:    1.0000
2025-08-08 09:44:56,348 - INFO -    ğŸ“ˆ F1 Score:  0.8468
2025-08-08 09:44:56,348 - INFO -    ğŸ“ˆ ROC AUC:   0.9906
2025-08-08 09:44:56,348 - INFO -    ğŸ“Š True distribution: {np.float32(0.0): np.int64(152), np.float32(1.0): np.int64(324)}
2025-08-08 09:44:56,348 - INFO -    ğŸ“Š Pred distribution: {np.int64(0): np.int64(207), np.int64(1): np.int64(269)}
2025-08-08 09:44:56,348 - INFO - ğŸ” Evaluating on test set (122 samples)...
2025-08-08 09:44:56,360 - INFO - ğŸ“Š TEST RESULTS (Non-readable as positive):
2025-08-08 09:44:56,360 - INFO -    ğŸ“ˆ Accuracy:  0.7049
2025-08-08 09:44:56,360 - INFO -    ğŸ“ˆ Precision: 0.5490
2025-08-08 09:44:56,360 - INFO -    ğŸ“ˆ Recall:    0.6829
2025-08-08 09:44:56,360 - INFO -    ğŸ“ˆ F1 Score:  0.6087
2025-08-08 09:44:56,360 - INFO -    ğŸ“ˆ ROC AUC:   0.7820
2025-08-08 09:44:56,361 - INFO -    ğŸ“Š True distribution: {np.float32(0.0): np.int64(41), np.float32(1.0): np.int64(81)}
2025-08-08 09:44:56,361 - INFO -    ğŸ“Š Pred distribution: {np.int64(0): np.int64(51), np.int64(1): np.int64(71)}
2025-08-08 09:44:56,361 - INFO - ğŸ“„ Performance metrics saved to: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357/performance_metrics.txt
2025-08-08 09:44:56,365 - INFO - ğŸ’¾ Model saved to: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357/best_model.pkl
2025-08-08 09:44:56,369 - INFO - ğŸ’¾ Results saved to: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357/results.json
2025-08-08 09:44:56,378 - INFO - ğŸ’¾ CV results saved to: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357/cv_results.csv
2025-08-08 09:44:56,379 - INFO - ğŸ“Š Creating visualization plots...
2025-08-08 09:44:56,384 - INFO -    ğŸ“ˆ Creating feature importance plot...
2025-08-08 09:44:57,043 - INFO -    ğŸ“ˆ Creating confusion matrix...
2025-08-08 09:44:57,389 - INFO -    ğŸ“ˆ Creating ROC curve...
2025-08-08 09:44:57,722 - INFO -    ğŸ“ˆ Creating hyperparameter search visualization...
2025-08-08 09:44:59,049 - INFO - âœ… All 4 plots created successfully
2025-08-08 09:44:59,049 - INFO - ğŸ“ Plots saved to: readability_training_pagewise/experiments/xgboost_efficientnet_random_under_nonreadable_20250808_094357/plots
